# ä½¿ç”¨æ¡ˆä¾‹ 07ï¼šGoogle Analytics 4 æ•¸æ“šè¿½è¹¤

## ğŸ“‹ åŸºæœ¬è³‡è¨Š

**ä½¿ç”¨æ¡ˆä¾‹åç¨±**ï¼šGA4 + GTM æ•¸æ“šè¿½è¹¤èˆ‡åˆ†æ
**ä½¿ç”¨æ¡ˆä¾‹ ID**ï¼šUC-07
**é é¢**ï¼š`card.html`
**å„ªå…ˆç´š**ï¼šé«˜
**ç‹€æ…‹**ï¼šå·²å¯¦ä½œ

## ğŸ¯ æ¦‚è¿°

é€é Google Tag Manager (GTM) å’Œ Google Analytics 4 (GA4) è¿½è¹¤ä½¿ç”¨è€…åœ¨æŠ½å¡ç³»çµ±ä¸­çš„å®Œæ•´è¡Œç‚ºï¼ŒåŒ…æ‹¬é é¢è¼‰å…¥ã€å¡ç‰‡æŠ½å–ã€ä¸­çäº’å‹•ã€è¡¨å–®æäº¤ç­‰é—œéµäº‹ä»¶ã€‚ç³»çµ±æ¡ç”¨ Cookie åŒæ„æ©Ÿåˆ¶ï¼Œç¬¦åˆ GDPR éš±ç§æ³•è¦è¦æ±‚ï¼Œç¢ºä¿åœ¨å–å¾—ä½¿ç”¨è€…åŒæ„å¾Œæ‰é€²è¡Œæ•¸æ“šè¿½è¹¤ã€‚

## ğŸ‘¥ åƒèˆ‡è€…

- **ä¸»è¦åƒèˆ‡è€…**ï¼šä½¿ç”¨è€…ï¼ˆè¨ªå•æŠ½å¡é é¢çš„ä½¿ç”¨è€…ï¼‰
- **æ¬¡è¦åƒèˆ‡è€…**ï¼š
  - è¡ŒéŠ·åœ˜éšŠï¼ˆåˆ†ææ•¸æ“šã€å„ªåŒ–è¡ŒéŠ·ç­–ç•¥ï¼‰
  - ç”¢å“ç¶“ç†ï¼ˆç›£æ§ä½¿ç”¨è€…è¡Œç‚ºã€æ”¹å–„ç”¢å“ï¼‰
  - é–‹ç™¼åœ˜éšŠï¼ˆç¶­è­·è¿½è¹¤ç³»çµ±ã€ä¿®å¾©å•é¡Œï¼‰

## ğŸ¬ å‰ç½®æ¢ä»¶

- å·²è¨­å®š Google Tag Manager å®¹å™¨ï¼ˆGTM-XXXXXXXï¼‰
- å·²å»ºç«‹ Google Analytics 4 è³‡æºï¼ˆG-XXXXXXXXXXï¼‰
- GTM å®¹å™¨å·²ç™¼å¸ƒä¸”åŒ…å« GA4 è¨­å®šæ¨™ç±¤
- ä½¿ç”¨è€…ç€è¦½å™¨æ”¯æ´ JavaScript å’Œ localStorage
- è¿½è¹¤ç³»çµ±æª”æ¡ˆå·²æ­£ç¢ºè¼‰å…¥ï¼ˆcookie-consent.jsã€gtm-datalayer.jsï¼‰

## âœ… å¾Œç½®æ¢ä»¶

### æˆåŠŸæƒ…å¢ƒ
- ä½¿ç”¨è€…åŒæ„ Cookie ä½¿ç”¨å¾Œï¼ŒGTM æˆåŠŸè¼‰å…¥
- æ‰€æœ‰é—œéµäº‹ä»¶æˆåŠŸæ¨é€è‡³ dataLayer
- äº‹ä»¶è³‡æ–™æ­£ç¢ºå‚³é€è‡³ GA4
- æ•¸æ“šå¯åœ¨ GA4 å ±è¡¨ä¸­æŸ¥çœ‹å’Œåˆ†æ
- ç„¡å€‹äººéš±ç§è³‡è¨Šï¼ˆPIIï¼‰å¤–æ´©

### å¤±æ•—æƒ…å¢ƒ
- ä½¿ç”¨è€…æ‹’çµ• Cookieï¼Œç„¡æ•¸æ“šè¿½è¹¤
- GTM è¼‰å…¥å¤±æ•—ï¼Œäº‹ä»¶é€²å…¥ä½‡åˆ—ç­‰å¾…
- ç¶²è·¯éŒ¯èª¤å°è‡´äº‹ä»¶éºå¤±
- GA4 è¨­å®šéŒ¯èª¤ï¼Œäº‹ä»¶ç„¡æ³•æ­£ç¢ºæ­¸å› 

## ğŸ“ ä¸»è¦æµç¨‹

```mermaid
flowchart TD
    A[ä½¿ç”¨è€…è¨ªå• card.html] --> B{Cookie åŒæ„ç‹€æ…‹ï¼Ÿ}
    B -->|å·²åŒæ„| C[ç›´æ¥è¼‰å…¥ GTM]
    B -->|å·²æ‹’çµ•| D[ä¸è¼‰å…¥ä»»ä½•è¿½è¹¤]
    B -->|å°šæœªæ±ºå®š| E[é¡¯ç¤º Cookie åŒæ„æ©«å¹…]

    E --> F{ä½¿ç”¨è€…é¸æ“‡ï¼Ÿ}
    F -->|é»æ“Šã€Œæ¥å—ã€| G[å„²å­˜åŒæ„ç‹€æ…‹]
    F -->|é»æ“Šã€Œæ‹’çµ•ã€| H[å„²å­˜æ‹’çµ•ç‹€æ…‹]

    G --> I[è¼‰å…¥ GTM å®¹å™¨]
    H --> D

    I --> J[åˆå§‹åŒ– dataLayer]
    J --> K[æ¨é€ page_load_start äº‹ä»¶]

    K --> L{ä½¿ç”¨è€…è¡Œç‚º}

    L -->|æˆåŠŸæŠ½å¡| M[æ¨é€ card_draw_success]
    L -->|è¢«é€Ÿç‡é™åˆ¶| N[æ¨é€ rate_limit_blocked]
    L -->|é»æ“Šä¸­çæ–‡å­—| O[æ¨é€ winner_overlay_clicked]
    L -->|é–‹å•Ÿè¯çµ¡è¡¨å–®| P[æ¨é€ contact_form_shown]
    L -->|æäº¤è¡¨å–®| Q[æ¨é€ contact_form_submission_success]
    L -->|ç„¡æ•ˆè¨ªå•| R[æ¨é€ access_denied]

    M --> S[GTM è™•ç†äº‹ä»¶]
    N --> S
    O --> S
    P --> S
    Q --> S
    R --> S

    S --> T[è§¸ç™¼å™¨å•Ÿå‹•]
    T --> U[GA4 äº‹ä»¶æ¨™ç±¤åŸ·è¡Œ]
    U --> V[è³‡æ–™å‚³é€è‡³ GA4]
    V --> W[å³æ™‚å ±è¡¨æ›´æ–°]
    W --> X[åˆ†æå¸«æŸ¥çœ‹æ•¸æ“š]

    D --> Y[æ­£å¸¸ä½¿ç”¨ç¶²ç«™åŠŸèƒ½]
    C --> K
```

### è©³ç´°æ­¥é©Ÿ

#### éšæ®µä¸€ï¼šCookie åŒæ„èˆ‡ GTM è¼‰å…¥

1. **ä½¿ç”¨è€…è¨ªå•é é¢**
   - è¼‰å…¥ `card.html`
   - åˆå§‹åŒ– `cookie-consent.js`
   - æª¢æŸ¥ localStorage ä¸­çš„åŒæ„ç‹€æ…‹

2. **åˆ¤æ–·åŒæ„ç‹€æ…‹**
   - **è‹¥å·²åŒæ„ï¼ˆacceptedï¼‰**ï¼š
     - ç›´æ¥è¼‰å…¥ GTM å®¹å™¨
     - åˆå§‹åŒ– dataLayer
     - åŸ·è¡Œæ‰€æœ‰ onAccept å›èª¿
   - **è‹¥å·²æ‹’çµ•ï¼ˆdeclinedï¼‰**ï¼š
     - ä¸è¼‰å…¥ä»»ä½•è¿½è¹¤
     - é é¢æ­£å¸¸é‹ä½œï¼Œç„¡åŠŸèƒ½é™åˆ¶
   - **è‹¥å°šæœªæ±ºå®šï¼ˆnullï¼‰**ï¼š
     - é¡¯ç¤º Cookie åŒæ„æ©«å¹…æ–¼é é¢åº•éƒ¨
     - æ©«å¹…å…§å®¹ï¼šã€Œæˆ‘å€‘ä½¿ç”¨ Cookie å’Œåˆ†æå·¥å…·ä¾†æ”¹å–„æ‚¨çš„ä½¿ç”¨é«”é©—ä¸¦åˆ†æç¶²ç«™æµé‡ã€
     - æä¾›ã€Œæ¥å—ã€å’Œã€Œæ‹’çµ•ã€æŒ‰éˆ•

3. **ä½¿ç”¨è€…é»æ“Šã€Œæ¥å—ã€**
   - å°‡ç‹€æ…‹ `{ status: "accepted", timestamp, version: 1 }` å­˜å…¥ localStorage
   - é—œé–‰æ©«å¹…ï¼ˆæ·¡å‡ºå‹•ç•«ï¼‰
   - åŸ·è¡Œ GTM è¼‰å…¥å‡½å¼
   - GTM å®¹å™¨éåŒæ­¥è¼‰å…¥
   - æ§åˆ¶å°é¡¯ç¤ºï¼šã€Œâœ… GTM loaded: GTM-ABC1234ã€

4. **ä½¿ç”¨è€…é»æ“Šã€Œæ‹’çµ•ã€**
   - å°‡ç‹€æ…‹ `{ status: "declined", timestamp, version: 1 }` å­˜å…¥ localStorage
   - é—œé–‰æ©«å¹…
   - ä¸åŸ·è¡Œä»»ä½•è¿½è¹¤ç›¸é—œç¨‹å¼ç¢¼
   - é é¢ç¹¼çºŒæ­£å¸¸é‹ä½œ

#### éšæ®µäºŒï¼šäº‹ä»¶è¿½è¹¤ï¼ˆå·²åŒæ„çš„æƒ…æ³ï¼‰

5. **é é¢è¼‰å…¥äº‹ä»¶**
   - è§¸ç™¼æ™‚æ©Ÿï¼š`initializeApp()` å‡½å¼é–‹å§‹åŸ·è¡Œ
   - äº‹ä»¶åç¨±ï¼š`page_load_start`
   - åŒ…å«è³‡æ–™ï¼š
     - dev_modeï¼šæ˜¯å¦ç‚ºé–‹ç™¼æ¨¡å¼
     - sheet_idï¼šGoogle Sheets ID
     - timestampï¼šé é¢è¼‰å…¥æ™‚é–“æˆ³è¨˜

6. **å¡ç‰‡æŠ½å–æˆåŠŸ**
   - è§¸ç™¼æ™‚æ©Ÿï¼šå¡ç‰‡æˆåŠŸé¡¯ç¤ºæ–¼é é¢
   - äº‹ä»¶åç¨±ï¼š`card_draw_success`
   - åŒ…å«è³‡æ–™ï¼š
     - selected_imageï¼šé¸ä¸­çš„åœ–ç‰‡æª”å
     - selected_text_titleï¼šé¸ä¸­çš„æ–‡å­—æ¨™é¡Œ
     - text_probabilityï¼šè©²æ–‡å­—çš„æ©Ÿç‡æ¬Šé‡
     - is_winnerï¼šæ˜¯å¦ç‚ºä¸­çå¡ç‰‡
     - text_description_lengthï¼šæè¿°æ–‡å­—é•·åº¦
     - total_available_textsï¼šå¯ç”¨æ–‡å­—ç¸½æ•¸
     - total_available_imagesï¼šå¯ç”¨åœ–ç‰‡ç¸½æ•¸

7. **ä¸­çè€…é»æ“Šæ–‡å­—**
   - è§¸ç™¼æ™‚æ©Ÿï¼šä½¿ç”¨è€…é»æ“Šä¸­çå¡ç‰‡çš„æ–‡å­—ç–ŠåŠ å±¤
   - äº‹ä»¶åç¨±ï¼š`winner_overlay_clicked`
   - åŒ…å«è³‡æ–™ï¼š
     - prize_titleï¼šçå“åç¨±ï¼ˆå¾é…ç½®è¡¨è¼‰å…¥ï¼‰
     - card_titleï¼šä¸­çå¡ç‰‡æ¨™é¡Œ
     - time_on_page_msï¼šå¾é é¢è¼‰å…¥åˆ°é»æ“Šçš„æ™‚é–“

8. **é€Ÿç‡é™åˆ¶é˜»æ“‹**
   - è§¸ç™¼æ™‚æ©Ÿï¼šä½¿ç”¨è€…å› å†·å»æ™‚é–“æœªåˆ°è€Œè¢«é˜»æ“‹
   - äº‹ä»¶åç¨±ï¼š`rate_limit_blocked`
   - åŒ…å«è³‡æ–™ï¼š
     - reasonï¼šé˜»æ“‹åŸå› ï¼ˆ"rate_limited"ï¼‰
     - remaining_time_msï¼šå‰©é¤˜å†·å»æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰
     - cooldown_end_timeï¼šå†·å»çµæŸæ™‚é–“æˆ³è¨˜

9. **è¯çµ¡è¡¨å–®æäº¤æˆåŠŸ**
   - è§¸ç™¼æ™‚æ©Ÿï¼šä¸­çè€…æˆåŠŸæäº¤è¯çµ¡è³‡è¨Š
   - äº‹ä»¶åç¨±ï¼š`contact_form_submission_success`
   - åŒ…å«è³‡æ–™ï¼š
     - prize_titleï¼šçå“åç¨±
     - submission_methodï¼šæäº¤æ–¹å¼ï¼ˆ"web_app"ï¼‰
     - time_to_submit_msï¼šå¾é–‹å§‹å¡«å¯«åˆ°æäº¤æˆåŠŸçš„æ™‚é–“
   - **æ³¨æ„**ï¼šä¸åŒ…å«ä»»ä½•å€‹äººè³‡æ–™ï¼ˆé›»è©±ã€åœ°å€ã€å§“åç­‰ï¼‰

10. **è¨ªå•æ§åˆ¶æ‹’çµ•**
    - è§¸ç™¼æ™‚æ©Ÿï¼šä½¿ç”¨è€…æœªé€éæ­£ç¢ºçš„ URL è¨ªå•é é¢
    - äº‹ä»¶åç¨±ï¼š`access_denied`
    - åŒ…å«è³‡æ–™ï¼š
      - error_message_titleï¼šéŒ¯èª¤è¨Šæ¯æ¨™é¡Œ
      - urlï¼šå˜—è©¦è¨ªå•çš„å®Œæ•´ URL
      - referrerï¼šä¾†æºç¶²å€æˆ– "direct"
      - found_paramï¼šæ‰¾åˆ°çš„æŸ¥è©¢åƒæ•¸ï¼ˆè‹¥æœ‰ï¼‰

#### éšæ®µä¸‰ï¼šGTM è™•ç†èˆ‡ GA4 å‚³é€

11. **dataLayer äº‹ä»¶æ¨é€**
    - ä½¿ç”¨ `window.pushToDataLayer(eventName, eventData)` å‡½å¼
    - è‡ªå‹•æª¢æŸ¥ Cookie åŒæ„ç‹€æ…‹
    - è‡ªå‹•éæ¿¾å€‹äººéš±ç§è³‡è¨Šï¼ˆPIIï¼‰
    - åŠ ä¸Šæ™‚é–“æˆ³è¨˜å’ŒåŒæ„ç‹€æ…‹

12. **GTM è§¸ç™¼å™¨å•Ÿå‹•**
    - è‡ªè¨‚äº‹ä»¶è§¸ç™¼å™¨ç›£è½ dataLayer
    - äº‹ä»¶åç¨±å®Œå…¨ç¬¦åˆæ™‚è§¸ç™¼
    - ä¾‹å¦‚ï¼šã€ŒCE - Card Draw Successã€ç›£è½ `card_draw_success` äº‹ä»¶

13. **GA4 äº‹ä»¶æ¨™ç±¤åŸ·è¡Œ**
    - è§¸ç™¼å™¨å•Ÿå‹•å¾ŒåŸ·è¡Œå°æ‡‰çš„ GA4 äº‹ä»¶æ¨™ç±¤
    - å¾ dataLayer è®Šæ•¸ä¸­æå–äº‹ä»¶åƒæ•¸
    - ä½¿ç”¨ GA4 è¨­å®šæ¨™ç±¤çš„ Measurement ID
    - çµ„æˆå®Œæ•´çš„ GA4 äº‹ä»¶ä¸¦å‚³é€

14. **GA4 æ¥æ”¶èˆ‡è™•ç†**
    - äº‹ä»¶å‚³é€è‡³ Google Analytics 4 ä¼ºæœå™¨
    - 5-10 ç§’å¾Œå‡ºç¾åœ¨ DebugViewï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰
    - æ•¸åˆ†é˜å¾Œå‡ºç¾åœ¨å³æ™‚å ±è¡¨
    - 24-48 å°æ™‚å¾Œå®Œæ•´è™•ç†ä¸¦æ­¸å…¥æ¨™æº–å ±è¡¨

## ğŸ”€ æ›¿ä»£æµç¨‹

### 3a. ä½¿ç”¨è€…å·²åœ¨ä¹‹å‰è¨ªå•æ™‚æ‹’çµ• Cookie

**æ¢ä»¶**ï¼šlocalStorage ä¸­å­˜åœ¨ `status: "declined"` çš„åŒæ„è¨˜éŒ„

**æµç¨‹**ï¼š
1. Cookie åŒæ„ç®¡ç†å™¨åˆå§‹åŒ–
2. è®€å–åˆ°æ‹’çµ•ç‹€æ…‹
3. ä¸é¡¯ç¤ºæ©«å¹…
4. ä¸è¼‰å…¥ GTM
5. é é¢æ­£å¸¸é‹ä½œ
6. **ç„¡ä»»ä½•æ•¸æ“šè¿½è¹¤**

### 6a. ä½¿ç”¨è€…åœ¨åŒæ„å‰è§¸ç™¼äº†äº‹ä»¶

**æ¢ä»¶**ï¼šé é¢è¼‰å…¥æ™‚å°šæœªåŒæ„ï¼Œä½† JavaScript å·²å˜—è©¦æ¨é€äº‹ä»¶

**æµç¨‹**ï¼š
1. `pushToDataLayer()` è¢«å‘¼å«
2. æª¢æ¸¬åˆ°ç„¡åŒæ„ç‹€æ…‹
3. äº‹ä»¶è¢«åŠ å…¥æš«å­˜ä½‡åˆ—ï¼ˆ`eventQueue`ï¼‰
4. æ§åˆ¶å°é¡¯ç¤ºï¼šã€ŒEvent "xxx" queued (no consent yet)ã€
5. ä½¿ç”¨è€…ç¨å¾Œé»æ“Šã€Œæ¥å—ã€
6. GTM è¼‰å…¥å®Œæˆ
7. è‡ªå‹•æ¸…ç©ºä½‡åˆ—ï¼Œä¾åºæ¨é€æ‰€æœ‰äº‹ä»¶

### 9a. è¡¨å–®æäº¤å¤±æ•—

**æ¢ä»¶**ï¼šç¶²è·¯éŒ¯èª¤æˆ– Google Apps Script éŒ¯èª¤

**æµç¨‹**ï¼š
1. ä½¿ç”¨è€…å¡«å¯«ä¸¦æäº¤ä¸­çè¡¨å–®
2. `contact_form_submission_start` äº‹ä»¶æ¨é€
3. æäº¤è‡³ Google Sheets å¤±æ•—
4. `contact_form_submission_error` äº‹ä»¶æ¨é€
5. åŒ…å«è³‡æ–™ï¼š
   - error_messageï¼šéŒ¯èª¤è¨Šæ¯
   - error_typeï¼šéŒ¯èª¤é¡å‹
   - retry_availableï¼štrueï¼ˆå¯é‡è©¦ï¼‰
6. è¡¨å–®ä¿æŒé–‹å•Ÿï¼Œä½¿ç”¨è€…å¯é‡æ–°å˜—è©¦

### 13a. GTM æ¨™ç±¤åŸ·è¡Œå¤±æ•—

**æ¢ä»¶**ï¼šGA4 è¨­å®šæ¨™ç±¤é…ç½®éŒ¯èª¤æˆ– Measurement ID ç„¡æ•ˆ

**æµç¨‹**ï¼š
1. GTM è§¸ç™¼å™¨æ­£å¸¸å•Ÿå‹•
2. GA4 äº‹ä»¶æ¨™ç±¤å˜—è©¦åŸ·è¡Œ
3. å› è¨­å®šéŒ¯èª¤è€Œå¤±æ•—
4. GTM Preview Mode é¡¯ç¤ºæ¨™ç±¤ç‹€æ…‹ç‚ºã€ŒFailedã€
5. GA4 ä¸æœƒæ”¶åˆ°äº‹ä»¶
6. éœ€è¦æª¢æŸ¥ GTM è¨­å®šä¸¦ä¿®æ­£

## ğŸ¨ ä»‹é¢å…ƒç´ 

### Cookie åŒæ„æ©«å¹…

**ä½ç½®**ï¼šé é¢åº•éƒ¨å›ºå®š
**æ¨£å¼**ï¼š
- èƒŒæ™¯ï¼šç´«è‰²æ¼¸å±¤ï¼ˆ#667eea â†’ #764ba2ï¼‰
- é™°å½±ï¼š0 -4px 20px rgba(0, 0, 0, 0.2)
- å‹•ç•«ï¼šå¾åº•éƒ¨æ»‘å…¥ï¼ˆtransform: translateY(100%) â†’ 0ï¼‰

**å…§å®¹**ï¼š
```
ğŸª Cookie ä½¿ç”¨è²æ˜

æˆ‘å€‘ä½¿ç”¨ Cookie å’Œåˆ†æå·¥å…·ä¾†æ”¹å–„æ‚¨çš„ä½¿ç”¨é«”é©—ä¸¦åˆ†æç¶²ç«™æµé‡ã€‚
é»æ“Šã€Œæ¥å—ã€å³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘å€‘ä½¿ç”¨ Cookie å’Œ Google Analytics è¿½è¹¤ã€‚

[æ‹’çµ•]  [æ¥å—]
```

**éŸ¿æ‡‰å¼è¨­è¨ˆ**ï¼š
- æ¡Œé¢ç‰ˆï¼ˆ> 768pxï¼‰ï¼šæ©«å‘æ’åˆ—ï¼Œå…§å®¹èˆ‡æŒ‰éˆ•ä¸¦æ’
- å¹³æ¿ç‰ˆï¼ˆâ‰¤ 768pxï¼‰ï¼šå‚ç›´æ’åˆ—ï¼ŒæŒ‰éˆ•æ°´å¹³ä¸¦æ’
- æ‰‹æ©Ÿç‰ˆï¼ˆâ‰¤ 480pxï¼‰ï¼šå®Œå…¨å‚ç›´ï¼ŒæŒ‰éˆ•å †ç–Šæ’åˆ—

### GA4 äº‹ä»¶ï¼ˆä½¿ç”¨è€…ä¸å¯è¦‹ï¼‰

è¿½è¹¤ç³»çµ±åœ¨èƒŒæ™¯åŸ·è¡Œï¼Œä½¿ç”¨è€…ç„¡æ³•ç›´æ¥çœ‹åˆ°æˆ–æ„ŸçŸ¥åˆ°æ•¸æ“šè¿½è¹¤éç¨‹ã€‚å”¯ä¸€å¯è¦‹çš„å…ƒç´ æ˜¯ Cookie åŒæ„æ©«å¹…ã€‚

## ğŸ’¾ è³‡æ–™çµæ§‹

### Cookie åŒæ„ç‹€æ…‹

**å„²å­˜ä½ç½®**ï¼šlocalStorage
**éµå**ï¼š`cookie_consent_status`

```json
{
  "status": "accepted",
  "timestamp": "2025-11-08T12:34:56.789Z",
  "version": 1
}
```

### dataLayer äº‹ä»¶ç¯„ä¾‹

#### å¡ç‰‡æŠ½å–æˆåŠŸäº‹ä»¶

```javascript
{
  "event": "card_draw_success",
  "selected_image": "images/backgrounds/gradient-1.svg",
  "selected_text_title": "ä»Šå¤©å¾ˆé–‹å¿ƒ",
  "text_probability": 0.3,
  "is_winner": false,
  "text_description_length": 45,
  "total_available_texts": 8,
  "total_available_images": 5,
  "_timestamp": 1730000000000,
  "_consent_status": "accepted"
}
```

#### ä¸­çè€…é»æ“Šäº‹ä»¶

```javascript
{
  "event": "winner_overlay_clicked",
  "prize_title": "ç²¾ç¾ç¦®å“",
  "card_title": "æŠ½ä¸­å¤§çï¼",
  "time_on_page_ms": 2500,
  "_timestamp": 1730000002500,
  "_consent_status": "accepted"
}
```

#### è¡¨å–®æäº¤æˆåŠŸäº‹ä»¶

```javascript
{
  "event": "contact_form_submission_success",
  "prize_title": "ç²¾ç¾ç¦®å“",
  "submission_method": "web_app",
  "time_to_submit_ms": 1250,
  "_timestamp": 1730000005000,
  "_consent_status": "accepted"
}
```

**æ³¨æ„**ï¼šæ‰€æœ‰äº‹ä»¶è‡ªå‹•åŒ…å«ï¼š
- `_timestamp`ï¼šæ¨é€æ™‚é–“ï¼ˆUnix æ¯«ç§’ï¼‰
- `_consent_status`ï¼šåŒæ„ç‹€æ…‹ï¼ˆ"accepted" | "declined" | "pending"ï¼‰

## ğŸ“Š è¿½è¹¤äº‹ä»¶ç¸½è¦½

### é«˜å„ªå…ˆç´šäº‹ä»¶ï¼ˆæ ¸å¿ƒæ¥­å‹™æŒ‡æ¨™ï¼‰

| äº‹ä»¶åç¨± | è§¸ç™¼æ™‚æ©Ÿ | æ¥­å‹™åƒ¹å€¼ |
|---------|---------|---------|
| `card_draw_success` | æˆåŠŸæŠ½å¡ | è¡¡é‡ä½¿ç”¨è€…åƒèˆ‡åº¦ã€åˆ†æç†±é–€å¡ç‰‡ |
| `contact_form_submission_success` | ä¸­çè¡¨å–®æäº¤ | è¿½è¹¤è½‰æ›ç‡ã€ç›£æ§ä¸­çè€…æ•¸é‡ |
| `winner_overlay_clicked` | ä¸­çè€…é»æ“Š | è©•ä¼°ä¸­çè€…åƒèˆ‡æ„é¡˜ |
| `rate_limit_blocked` | é€Ÿç‡é™åˆ¶é˜»æ“‹ | åˆ†æä½¿ç”¨è€…æ‘©æ“¦é»ã€å„ªåŒ–å†·å»æ™‚é–“ |
| `access_denied` | ç„¡æ•ˆè¨ªå• | ç›£æ§éæ³•è¨ªå•ã€æ”¹å–„å…¥å£é»è¨­è¨ˆ |

### ä¸­å„ªå…ˆç´šäº‹ä»¶ï¼ˆä½¿ç”¨è€…é«”é©—èˆ‡å¯é æ€§ï¼‰

| äº‹ä»¶åç¨± | è§¸ç™¼æ™‚æ©Ÿ | æ¥­å‹™åƒ¹å€¼ |
|---------|---------|---------|
| `contact_form_validation_error` | è¡¨å–®é©—è­‰å¤±æ•— | è­˜åˆ¥è¡¨å–®å•é¡Œã€æ”¹å–„ä½¿ç”¨è€…é«”é©— |
| `rate_limit_allowed` | é€šéé€Ÿç‡æª¢æŸ¥ | äº†è§£æˆåŠŸè¨ªå•ç‡ |
| `config_load_success/error` | é…ç½®è¼‰å…¥ | ç›£æ§ç³»çµ±å¥åº·åº¦ |
| `access_control_validation` | è¨ªå•é©—è­‰ | é©—è­‰å…¥å£é»æ•ˆæœ |

### ä½å„ªå…ˆç´šäº‹ä»¶ï¼ˆå¯é¸åˆ†æï¼‰

| äº‹ä»¶åç¨± | è§¸ç™¼æ™‚æ©Ÿ | æ¥­å‹™åƒ¹å€¼ |
|---------|---------|---------|
| `page_load_start` | é é¢è¼‰å…¥ | æ€§èƒ½ç›£æ§åŸºæº–é» |
| `contact_form_shown/hidden` | è¡¨å–®é–‹é—œ | è¡¨å–®äº’å‹•åˆ†æ |
| `initialization_error` | åˆå§‹åŒ–éŒ¯èª¤ | æŠ€è¡“å•é¡Œç›£æ§ |

## ğŸ”’ éš±ç§èˆ‡å®‰å…¨

### PIIï¼ˆå€‹äººè­˜åˆ¥è³‡è¨Šï¼‰é˜²è­·

ç³»çµ±è‡ªå‹•éæ¿¾ä»¥ä¸‹æ¬„ä½ï¼Œ**çµ•ä¸è¿½è¹¤**ï¼š
- âŒ é›»è©±è™Ÿç¢¼ï¼ˆphoneï¼‰
- âŒ é›»å­éƒµä»¶ï¼ˆemailï¼‰
- âŒ å®Œæ•´å§“åï¼ˆname, recipientNameï¼‰
- âŒ åœ°å€ï¼ˆaddressï¼‰
- âŒ å¸³è™Ÿ IDï¼ˆaccountï¼‰
- âŒ IP ä½å€
- âŒ ä½¿ç”¨è€… ID

### è¿½è¹¤çš„éš±ç§å®‰å…¨è³‡æ–™

åƒ…è¿½è¹¤èšåˆæ€§ã€ç„¡æ³•è­˜åˆ¥å€‹äººçš„è³‡æ–™ï¼š
- âœ… æ¬„ä½é•·åº¦ï¼ˆä¸å«å…§å®¹ï¼‰ï¼š`message_length: 45`
- âœ… å¸ƒæ—å€¼æ¨™è¨˜ï¼š`is_winner: true`, `has_phone: true`
- âœ… æˆªæ–·çš„é›œæ¹Šå€¼ï¼š`fingerprint_hash: "a3f5e8d2..."` ï¼ˆåƒ…å‰ 16 å­—å…ƒï¼‰
- âœ… è¨ˆæ•¸çµ±è¨ˆï¼š`error_count: 2`, `invalid_fields: ["phone", "address"]`
- âœ… æ™‚é–“æˆ³è¨˜ï¼š`timestamp: 1730000000`
- âœ… æ©Ÿç‡èˆ‡æ¬Šé‡ï¼š`text_probability: 0.3`

### GDPR åˆè¦æ€§

- âœ… **æ˜ç¢ºåŒæ„**ï¼šä½¿ç”¨è€…å¿…é ˆä¸»å‹•é»æ“Šã€Œæ¥å—ã€
- âœ… **å¯æ‹’çµ•é¸é …**ï¼šæä¾›ã€Œæ‹’çµ•ã€æŒ‰éˆ•ä¸”ç„¡åŠŸèƒ½æå¤±
- âœ… **é€æ˜èªªæ˜**ï¼šæ¸…æ¥šèªªæ˜ Cookie ç”¨é€”
- âœ… **é¸æ“‡æŒä¹…åŒ–**ï¼šåŒæ„æ±ºå®šå„²å­˜æ–¼ localStorage
- âœ… **ç„¡ PII å¤–æ´©**ï¼šè‡ªå‹•éæ¿¾æ©Ÿåˆ¶é˜²æ­¢éš±ç§è³‡æ–™æ´©æ¼
- âœ… **å¯æ’¤å›åŒæ„**ï¼šä½¿ç”¨è€…å¯æ¸…é™¤ localStorage é‡æ–°é¸æ“‡

## ğŸ“ˆ åˆ†ææ‡‰ç”¨å ´æ™¯

### å ´æ™¯ä¸€ï¼šå„ªåŒ–å¡ç‰‡å…§å®¹

**ç›®æ¨™**ï¼šäº†è§£å“ªäº›å¡ç‰‡æœ€å—æ­¡è¿

**ä½¿ç”¨äº‹ä»¶**ï¼š`card_draw_success`

**åˆ†ææ–¹å¼**ï¼š
1. åœ¨ GA4 ä¸­å»ºç«‹è‡ªè¨‚å ±è¡¨
2. ç¶­åº¦ï¼š`selected_text_title`
3. æŒ‡æ¨™ï¼šäº‹ä»¶è¨ˆæ•¸
4. ç¯©é¸ï¼š`is_winner = false`ï¼ˆæ’é™¤ä¸­çå¡ç‰‡ï¼‰
5. æ’åºï¼šç”±é«˜åˆ°ä½

**æ´å¯Ÿç¯„ä¾‹**ï¼š
- ç™¼ç¾ã€Œä»Šå¤©å¾ˆé–‹å¿ƒã€å‡ºç¾é »ç‡æœ€é«˜ï¼ˆ30%ï¼‰
- ã€Œå¾ˆæœŸå¾…æ˜å¤©ã€æ¬¡ä¹‹ï¼ˆ25%ï¼‰
- å¯èª¿æ•´æ©Ÿç‡æ¬Šé‡ä»¥å¹³è¡¡åˆ†å¸ƒ

### å ´æ™¯äºŒï¼šç›£æ§è½‰æ›æ¼æ–—

**ç›®æ¨™**ï¼šè¿½è¹¤å¾ä¸­çåˆ°æäº¤çš„å®Œæ•´æµç¨‹

**ä½¿ç”¨äº‹ä»¶**ï¼š
1. `card_draw_success` (is_winner = true)
2. `winner_overlay_clicked`
3. `contact_form_shown`
4. `contact_form_submission_success`

**åˆ†ææ–¹å¼**ï¼š
1. åœ¨ GA4 å»ºç«‹æ¼æ–—æ¢ç´¢
2. æ­¥é©Ÿ 1ï¼šä¸­çå¡ç‰‡é¡¯ç¤º
3. æ­¥é©Ÿ 2ï¼šé»æ“Šä¸­çæ–‡å­—
4. æ­¥é©Ÿ 3ï¼šé–‹å•Ÿè¡¨å–®
5. æ­¥é©Ÿ 4ï¼šæˆåŠŸæäº¤

**æ´å¯Ÿç¯„ä¾‹**ï¼š
- 100 äººæŠ½ä¸­çå“
- 85 äººé»æ“Šæ–‡å­—ï¼ˆ85% é»æ“Šç‡ï¼‰
- 78 äººé–‹å•Ÿè¡¨å–®ï¼ˆ91.8% é–‹å•Ÿç‡ï¼‰
- 65 äººæˆåŠŸæäº¤ï¼ˆ83.3% æäº¤ç‡ï¼‰
- **ç¸½è½‰æ›ç‡ï¼š65%**
- **æ”¹å–„æ©Ÿæœƒ**ï¼šæå‡è¡¨å–®æäº¤ç‡ï¼ˆå¯èƒ½çš„å•é¡Œï¼šæ¬„ä½éå¤šã€é©—è­‰éåš´ï¼‰

### å ´æ™¯ä¸‰ï¼šé€Ÿç‡é™åˆ¶æ•ˆæœåˆ†æ

**ç›®æ¨™**ï¼šè©•ä¼°å†·å»æ™‚é–“è¨­å®šæ˜¯å¦åˆç†

**ä½¿ç”¨äº‹ä»¶**ï¼š
- `rate_limit_blocked`
- `rate_limit_allowed`

**åˆ†ææ–¹å¼**ï¼š
1. è¨ˆç®—è¢«é˜»æ“‹ç‡ï¼šblocked / (blocked + allowed)
2. åˆ†æå‰©é¤˜å†·å»æ™‚é–“åˆ†å¸ƒï¼ˆ`remaining_time_ms`ï¼‰
3. å°æ¯”ä¸åŒå†·å»è¨­å®šçš„ä½¿ç”¨è€…æ»¿æ„åº¦

**æ´å¯Ÿç¯„ä¾‹**ï¼š
- è¢«é˜»æ“‹ç‡ï¼š35%
- å¹³å‡å‰©é¤˜æ™‚é–“ï¼š25 åˆ†é˜
- **çµè«–**ï¼š35% çš„ä½¿ç”¨è€…åœ¨å†·å»æœŸå…§é‡è¨ªï¼Œé¡¯ç¤ºé«˜åº¦åƒèˆ‡æ„é¡˜
- **å»ºè­°**ï¼šè€ƒæ…®ç¸®çŸ­å†·å»æ™‚é–“æˆ–æä¾›ã€Œåˆ†äº«ç²å¾—é¡å¤–æŠ½çã€æ©Ÿåˆ¶

### å ´æ™¯å››ï¼šè¨ªå•ä¾†æºè¿½è¹¤

**ç›®æ¨™**ï¼šäº†è§£ä½¿ç”¨è€…å¾ä½•è€Œä¾†

**ä½¿ç”¨äº‹ä»¶**ï¼š
- `access_denied`ï¼ˆreferrer æ¬„ä½ï¼‰
- `access_control_validation`ï¼ˆæ­£å¸¸è¨ªå•ï¼‰

**åˆ†ææ–¹å¼**ï¼š
1. ç¶­åº¦ï¼š`referrer`
2. æŒ‡æ¨™ï¼šäº‹ä»¶è¨ˆæ•¸
3. å€åˆ†æœ‰æ•ˆè¨ªå•èˆ‡ç„¡æ•ˆè¨ªå•

**æ´å¯Ÿç¯„ä¾‹**ï¼š
- æœ‰æ•ˆè¨ªå•ï¼ˆæœ‰ `?from=picsee`ï¼‰ï¼š85%
- ç„¡æ•ˆè¨ªå•ä¾†æºï¼š
  - ç›´æ¥è¼¸å…¥ç¶²å€ï¼š8%
  - ç¤¾ç¾¤åˆ†äº«é€£çµï¼ˆç„¡åƒæ•¸ï¼‰ï¼š5%
  - æœå°‹å¼•æ“ï¼š2%
- **è¡Œå‹•**ï¼šåœ¨ç¤¾ç¾¤åˆ†äº«åŠ ä¸Šæ­£ç¢ºåƒæ•¸ã€æ•™è‚²ä½¿ç”¨è€…é€é QR Code è¨ªå•

## ğŸ§ª æ¸¬è©¦æ¡ˆä¾‹

### TC-01: Cookie åŒæ„æ©«å¹…é¦–æ¬¡é¡¯ç¤º

1. æ¸…é™¤ç€è¦½å™¨ localStorage
2. è¨ªå• `card.html?from=picsee`
3. **é æœŸ**ï¼šCookie åŒæ„æ©«å¹…å¾åº•éƒ¨æ»‘å…¥
4. **é æœŸ**ï¼šå°šæœªè¼‰å…¥ GTMï¼ˆæª¢æŸ¥ Network æ¨™ç±¤ï¼‰

### TC-02: æ¥å— Cookie å¾Œ GTM è¼‰å…¥

1. å®Œæˆ TC-01
2. é»æ“Šã€Œæ¥å—ã€æŒ‰éˆ•
3. **é æœŸ**ï¼šæ©«å¹…æ·¡å‡ºä¸¦æ¶ˆå¤±
4. **é æœŸ**ï¼šæ§åˆ¶å°é¡¯ç¤ºã€Œâœ… GTM loaded: GTM-XXXXXXXã€
5. **é æœŸ**ï¼šNetwork æ¨™ç±¤é¡¯ç¤º GTM è…³æœ¬è¼‰å…¥
6. **é æœŸ**ï¼š`window.google_tag_manager` å­˜åœ¨

### TC-03: æ‹’çµ• Cookie ä¸è¿½è¹¤

1. æ¸…é™¤ localStorage
2. è¨ªå•é é¢
3. é»æ“Šã€Œæ‹’çµ•ã€æŒ‰éˆ•
4. **é æœŸ**ï¼šæ©«å¹…æ¶ˆå¤±
5. **é æœŸ**ï¼šä¸è¼‰å…¥ GTM
6. **é æœŸ**ï¼šé‡æ–°æ•´ç†é é¢å¾Œæ©«å¹…ä¸å†å‡ºç¾
7. **é æœŸ**ï¼šé é¢åŠŸèƒ½æ­£å¸¸é‹ä½œ

### TC-04: å¡ç‰‡æŠ½å–äº‹ä»¶è¿½è¹¤

1. æ¸…é™¤ localStorage ä¸¦æ¥å— Cookie
2. ç­‰å¾…å¡ç‰‡æŠ½å–å®Œæˆ
3. é–‹å•Ÿç€è¦½å™¨æ§åˆ¶å°
4. åŸ·è¡Œï¼š`console.table(window.dataLayer)`
5. **é æœŸ**ï¼šçœ‹åˆ° `card_draw_success` äº‹ä»¶
6. **é æœŸ**ï¼šåŒ…å« `selected_text_title`, `is_winner` ç­‰æ¬„ä½

### TC-05: ä¸­çæµç¨‹å®Œæ•´è¿½è¹¤

1. ä¿®æ”¹ Google Sheet è¨­å®šæŸæ–‡å­— `won=1`
2. æ¸…é™¤å¿«å–ä¸¦æ¥å— Cookie
3. æŠ½ä¸­ä¸­çå¡ç‰‡
4. é»æ“Šä¸­çæ–‡å­—
5. å¡«å¯«ä¸¦æäº¤è¡¨å–®
6. **é æœŸ dataLayer åŒ…å«ä»¥ä¸‹äº‹ä»¶ï¼ˆä¾åºï¼‰**ï¼š
   - `page_load_start`
   - `card_draw_success` (is_winner: true)
   - `winner_overlay_clicked`
   - `contact_form_shown`
   - `contact_form_submission_start`
   - `contact_form_submission_success`

### TC-06: GA4 DebugView é©—è­‰

1. åœ¨ GA4 é–‹å•Ÿ DebugView
2. åŸ·è¡Œ TC-05
3. **é æœŸ**ï¼šæ‰€æœ‰äº‹ä»¶åœ¨ 5-10 ç§’å…§å‡ºç¾æ–¼ DebugView
4. **é æœŸ**ï¼šäº‹ä»¶åƒæ•¸æ­£ç¢ºé¡¯ç¤º
5. **é æœŸ**ï¼šç„¡éŒ¯èª¤è¨Šæ¯

### TC-07: GTM Preview Mode é©—è­‰

1. åœ¨ GTM é»æ“Šã€ŒPreviewã€
2. è¼¸å…¥ `card.html?from=picsee`
3. æ¥å— Cookie
4. æŠ½å–å¡ç‰‡
5. **é æœŸ Tag Assistant é¡¯ç¤º**ï¼š
   - ã€ŒGA4 Configurationã€æ¨™ç±¤å·²è§¸ç™¼
   - ã€ŒGA4 Event - Card Draw Successã€æ¨™ç±¤å·²è§¸ç™¼
   - æ‰€æœ‰æ¨™ç±¤ç‹€æ…‹ç‚ºã€ŒFired Successfullyã€

### TC-08: PII é˜²è­·æ¸¬è©¦

1. é–‹å•Ÿæ§åˆ¶å° debug æ¨¡å¼ï¼š`window.dataLayerManager.enableDebug()`
2. å¡«å¯«ä¸­çè¡¨å–®ï¼ˆåŒ…å«é›»è©±ã€åœ°å€ç­‰ï¼‰
3. æäº¤è¡¨å–®
4. æª¢æŸ¥ `contact_form_submission_success` äº‹ä»¶
5. **é æœŸ**ï¼šä¸åŒ…å« `phone`, `address`, `recipientName` ç­‰ PII æ¬„ä½
6. **é æœŸ**ï¼šåƒ…åŒ…å« `prize_title`, `submission_method`, `time_to_submit_ms`

## ğŸ“Š å»ºè­°å ±è¡¨èˆ‡å„€è¡¨æ¿

### å„€è¡¨æ¿ 1ï¼šä½¿ç”¨è€…åƒèˆ‡æ¦‚è¦½

**æŒ‡æ¨™**ï¼š
- ç¸½è¨ªå•æ•¸ï¼ˆ`page_load_start` è¨ˆæ•¸ï¼‰
- æˆåŠŸæŠ½å¡æ•¸ï¼ˆ`card_draw_success` è¨ˆæ•¸ï¼‰
- è¢«é˜»æ“‹æ•¸ï¼ˆ`rate_limit_blocked` è¨ˆæ•¸ï¼‰
- ä¸­çæ•¸ï¼ˆ`card_draw_success` where `is_winner = true`ï¼‰
- è½‰æ›æ•¸ï¼ˆ`contact_form_submission_success` è¨ˆæ•¸ï¼‰

**åœ–è¡¨**ï¼š
- æŠ˜ç·šåœ–ï¼šæ¯æ—¥è¨ªå•è¶¨å‹¢
- åœ“é¤…åœ–ï¼šæŠ½å¡æˆåŠŸ vs. è¢«é˜»æ“‹æ¯”ä¾‹
- é•·æ¢åœ–ï¼šç†±é–€å¡ç‰‡æ’è¡Œï¼ˆä¾ `selected_text_title`ï¼‰

### å„€è¡¨æ¿ 2ï¼šè½‰æ›æ¼æ–—

**æ­¥é©Ÿ**ï¼š
1. ä¸­çå¡ç‰‡æŠ½ä¸­
2. é»æ“Šä¸­çæ–‡å­—
3. é–‹å•Ÿè¡¨å–®
4. æˆåŠŸæäº¤

**æŒ‡æ¨™**ï¼š
- å„æ­¥é©Ÿè½‰æ›ç‡
- å„æ­¥é©Ÿæµå¤±ç‡
- å¹³å‡æäº¤æ™‚é–“ï¼ˆ`time_to_submit_ms`ï¼‰

### å„€è¡¨æ¿ 3ï¼šç³»çµ±å¥åº·ç›£æ§

**æŒ‡æ¨™**ï¼š
- é…ç½®è¼‰å…¥æˆåŠŸç‡ï¼ˆ`config_load_success` / `config_load_error`ï¼‰
- è¡¨å–®æäº¤æˆåŠŸç‡ï¼ˆ`success` / `error`ï¼‰
- è¡¨å–®é©—è­‰éŒ¯èª¤åˆ†å¸ƒï¼ˆä¾ `invalid_fields`ï¼‰
- åˆå§‹åŒ–éŒ¯èª¤æ•¸ï¼ˆ`initialization_error` è¨ˆæ•¸ï¼‰

**è­¦å ±è¨­å®š**ï¼š
- é…ç½®è¼‰å…¥å¤±æ•—ç‡ > 5%
- è¡¨å–®æäº¤å¤±æ•—ç‡ > 10%
- åˆå§‹åŒ–éŒ¯èª¤æ•¸ > 10 æ¬¡/å¤©

### å„€è¡¨æ¿ 4ï¼šè¨ªå•æ§åˆ¶åˆ†æ

**æŒ‡æ¨™**ï¼š
- æœ‰æ•ˆè¨ªå•æ•¸ï¼ˆ`access_control_validation` where `access_granted = true`ï¼‰
- ç„¡æ•ˆè¨ªå•æ•¸ï¼ˆ`access_denied` è¨ˆæ•¸ï¼‰
- è¨ªå•ä¾†æºåˆ†å¸ƒï¼ˆä¾ `referrer`ï¼‰
- ç„¡æ•ˆè¨ªå•çš„æŸ¥è©¢åƒæ•¸ï¼ˆä¾ `found_param`ï¼‰

## ğŸ”— ç›¸é—œæ–‡ä»¶

- [æŠ€è¡“å¯¦ä½œæ–‡ä»¶ï¼ˆè‹±æ–‡ï¼‰](../ga4-gtm-implementation.md) - é–‹ç™¼è€…æŠ€è¡“æŒ‡å—
- [æŠ½å¡ç³»çµ±ï¼ˆå«ä¸­çï¼‰(UC-02)](02-card-drawing-with-prizes.md) - ä¸»è¦åŠŸèƒ½
- [ä¸­çè€…è³‡æ–™æ”¶é›† (UC-06)](06-winner-contact-collection.md) - è¡¨å–®æµç¨‹
- [é˜²åˆ·æ©Ÿåˆ¶ (UC-04)](04-rate-limiting.md) - é€Ÿç‡é™åˆ¶
- [å°ˆæ¡ˆèªªæ˜](../../CLAUDE.md) - æ•´é«”æ¶æ§‹

## ğŸ“ é™„è¨»

### Cookie åŒæ„æ©«å¹…å®¢è£½åŒ–

è‹¥éœ€ä¿®æ”¹æ©«å¹…æ–‡å­—æˆ–æ¨£å¼ï¼Œè«‹ç·¨è¼¯ï¼š
- **æ–‡å­—å…§å®¹**ï¼š`js/cookie-consent.js` ç¬¬ 89-103 è¡Œ
- **æ¨£å¼**ï¼š`css/cookie-consent.css`

### GTM å®¹å™¨ ID æ›´æ–°

**ä½ç½® 1**ï¼š`card.html` ç¬¬ 18 è¡Œ
```javascript
window.GTM_ID = 'GTM-ABC1234'; // æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš› ID
```

**ä½ç½® 2**ï¼š`card.html` ç¬¬ 52 è¡Œ
```html
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-ABC1234"
```

### Debug æ¨¡å¼å•Ÿç”¨

åœ¨ç€è¦½å™¨æ§åˆ¶å°åŸ·è¡Œï¼š
```javascript
// å•Ÿç”¨ dataLayer debug æ—¥èªŒ
window.dataLayerManager.enableDebug();

// æŸ¥çœ‹æ‰€æœ‰å·²æ¨é€äº‹ä»¶
console.table(window.dataLayer);

// é‡ç½® Cookie åŒæ„ï¼ˆæ¸¬è©¦ç”¨ï¼‰
window.cookieConsent.reset();
location.reload();
```

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-11-08
**æ–‡ä»¶ç‰ˆæœ¬**ï¼š1.0
**å¯¦ä½œç‹€æ…‹**ï¼šâœ… å·²å®Œæˆ
