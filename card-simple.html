<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>comoorÔΩúÊó•Â∏∏ÊµÆÁèæ Daily EmergenceÔΩúNFC ÂêäÁâåÊïÖ‰∫ãÁ≥ªÁµ±</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="comoorÔΩúÊó•Â∏∏ÊµÆÁèæÔºàDaily EmergenceÔºâÊòØ‰∏ÄÂ•óÁî±ÂØ¶È´îÂêäÁâå NFC Ëß∏ÁôºÁöÑÊïÖ‰∫ãÁ≥ªÁµ±„ÄÇÊÑüÊáâÂêäÁâåÂç≥ÂèØÈö®Ê©üÈÅáË¶ãÊó•Â∏∏ÊïÖ‰∫ã„ÄÅÈ°ßÂÆ¢ÂàÜ‰∫´ËàáÈ©öÂñúÂÖßÂÆπÔºåËÆìÊÉÖÊÑüËàáË®òÊÜ∂Âú®ÁîüÊ¥ª‰∏≠Ëá™ÁÑ∂ÊµÆÁèæ„ÄÇ">
    <meta name="keywords" content="comoor, Êó•Â∏∏ÊµÆÁèæ, Daily Emergence, NFC ÂêäÁâå, ÊïÖ‰∫ãÁ≥ªÁµ±, ÂìÅÁâåÊïÖ‰∫ã, ÂÆ¢Ë£ΩÂåñÂêäÁâå, NFC ÊÑüÊáâ, ‰∫íÂãïÊïÖ‰∫ã, ÁîüÊ¥ªÊïÖ‰∫ã, ÂìÅÁâåÈ´îÈ©ó, ÂØ¶È´î‰∫íÂãï, ÊäΩÂç°Ê¥ªÂãï, ÂüéÂ∏ÇÊâìÂç°, ËÅØÂêçÊïÖ‰∫ã">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://chicmoor.github.io/comoor/card-simple.html">
    <meta property="og:title" content="comoorÔΩúÊó•Â∏∏ÊµÆÁèæ Daily EmergenceÔΩúNFC ÂêäÁâåÊïÖ‰∫ãÁ≥ªÁµ±">
    <meta property="og:description" content="comoorÔΩúÊó•Â∏∏ÊµÆÁèæÔºàDaily EmergenceÔºâÊòØ‰∏ÄÂ•óÁî±ÂØ¶È´îÂêäÁâå NFC Ëß∏ÁôºÁöÑÊïÖ‰∫ãÁ≥ªÁµ±„ÄÇÊÑüÊáâÂêäÁâåÂç≥ÂèØÈö®Ê©üÈÅáË¶ãÊó•Â∏∏ÊïÖ‰∫ã„ÄÅÈ°ßÂÆ¢ÂàÜ‰∫´ËàáÈ©öÂñúÂÖßÂÆπÔºåËÆìÊÉÖÊÑüËàáË®òÊÜ∂Âú®ÁîüÊ¥ª‰∏≠Ëá™ÁÑ∂ÊµÆÁèæ„ÄÇ">
    <meta property="og:image" content="https://chicmoor.github.io/comoor/assets/images/comoor.jpg">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="comoorÔΩúÊó•Â∏∏ÊµÆÁèæ Daily EmergenceÔΩúNFC ÂêäÁâåÊïÖ‰∫ãÁ≥ªÁµ±">
    <meta name="twitter:description" content="comoorÔΩúÊó•Â∏∏ÊµÆÁèæÔºàDaily EmergenceÔºâÊòØ‰∏ÄÂ•óÁî±ÂØ¶È´îÂêäÁâå NFC Ëß∏ÁôºÁöÑÊïÖ‰∫ãÁ≥ªÁµ±„ÄÇÊÑüÊáâÂêäÁâåÂç≥ÂèØÈö®Ê©üÈÅáË¶ãÊó•Â∏∏ÊïÖ‰∫ã„ÄÅÈ°ßÂÆ¢ÂàÜ‰∫´ËàáÈ©öÂñúÂÖßÂÆπÔºåËÆìÊÉÖÊÑüËàáË®òÊÜ∂Âú®ÁîüÊ¥ª‰∏≠Ëá™ÁÑ∂ÊµÆÁèæ„ÄÇ">
    <meta name="twitter:image" content="https://chicmoor.github.io/comoor/assets/images/comoor.jpg">

    <!-- Access Control - Must load first -->
    <link rel="stylesheet" href="css/access-control.css">
    <script src="js/access-control.js"></script>

    <!-- Cookie Consent -->
    <link rel="stylesheet" href="css/cookie-consent.css">
    <script src="js/cookie-consent.js"></script>

    <!-- Google Tag Manager - Loaded conditionally after consent -->
    <script>
        // Initialize dataLayer
        window.dataLayer = window.dataLayer || [];

        // Load analytics configuration from config/analytics.json
        async function loadAnalyticsConfig() {
            try {
                const response = await fetch('config/analytics.json');
                if (response.ok) {
                    const config = await response.json();
                    console.log('‚öôÔ∏è Analytics config loaded:', config);
                    return config;
                } else {
                    console.warn('‚ö†Ô∏è Failed to load analytics config, using fallback');
                }
            } catch (error) {
                console.warn('‚ö†Ô∏è Failed to load analytics config:', error);
            }

            // Fallback config
            return {
                gtm: {
                    containerId: 'GTM-NQB6RCSF',
                    enabled: true
                }
            };
        }

        // Function to load GTM
        function loadGTM(gtmId) {
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer',gtmId);
            console.log('‚úÖ GTM loaded:', gtmId);

            // Configure cookie domain after GTM loads
            setTimeout(configureGA4CookieDomain, 1000); // Wait 1s for GTM to initialize
        }

        // Configure GA4 cookie domain
        function configureGA4CookieDomain() {
            console.log('üîß Configuring GA4 cookie domain...');

            // Method 1: Using dataLayer (recommended for GTM)
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': 'cookie_config',
                'cookie_domain': 'auto',
                'cookie_flags': 'SameSite=None;Secure'
            });

            // Method 2: Direct gtag configuration (fallback)
            // Wait for gtag to be available (loaded by GTM's GA4 tag)
            const waitForGtag = setInterval(function() {
                if (typeof window.gtag === 'function') {
                    clearInterval(waitForGtag);
                    window.gtag('config', 'G-3NKQDRH55Z', {
                        'cookie_domain': 'auto',
                        'cookie_flags': 'SameSite=None;Secure'
                    });
                    console.log('‚úÖ GA4 cookie domain configured via gtag');
                }
            }, 100);

            // Clear interval after 5 seconds to prevent infinite checking
            setTimeout(function() {
                clearInterval(waitForGtag);
            }, 5000);
        }

        // Initialize GTM with config
        async function initializeGTM() {
            const config = await loadAnalyticsConfig();

            if (!config.gtm.enabled) {
                console.log('üìä GTM disabled in config');
                return;
            }

            window.GTM_ID = config.gtm.containerId;
            window.analyticsConfig = config;

            // Load GTM if consent already granted
            if (window.cookieConsent && window.cookieConsent.consentStatus === 'accepted') {
                loadGTM(window.GTM_ID);
            }
        }

        // Load GTM when consent is granted
        if (window.cookieConsent) {
            window.cookieConsent.onAccept(async function() {
                if (!window.GTM_ID) {
                    await initializeGTM();
                } else {
                    loadGTM(window.GTM_ID);
                }
            });
        }

        // Initialize on page load
        initializeGTM();
    </script>

    <!-- DataLayer Helper -->
    <script src="js/gtm-datalayer.js"></script>

    <!-- Page Styles -->
    <link rel="stylesheet" href="css/card-simple.css">
    <link rel="stylesheet" href="css/text-overlay.css">
    <link rel="stylesheet" href="css/rate-limit-ui.css">
    <link rel="stylesheet" href="css/footer-ui.css">
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NQB6RCSF"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="container">
        <div class="image-container">
            <img id="cardImage" src="" alt="Card Image" class="card-image">
            <div id="textOverlay" class="text-overlay">
                <h3 class="text-overlay-title"></h3>
                <p class="text-overlay-description"></p>
            </div>

            <!-- Footer UI - Comment Input with Like Button -->
            <div id="footerUI" class="footer-ui">
                <div class="footer-input-wrapper">
                    <input
                        type="text"
                        id="footerInput"
                        class="footer-input"
                        placeholder="ÂØ´‰∏ãÊ≠§ÂàªËÖ¶Êµ∑‰∏≠ÊµÆÁèæÁöÑÈöªÂ≠óÁâáË™û..."
                        maxlength="500"
                        autocomplete="off"
                    >
                    <span id="footerCharCounter" class="footer-char-counter">0/500</span>
                    <svg id="footerSendIcon" class="footer-send-icon" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </div>
                <svg
                    id="footerHeartIcon"
                    class="footer-heart-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="white"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    data-outline='<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>'
                    data-filled='<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" fill="white"></path>'
                >
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                </svg>
            </div>

            <!-- Toast Notification -->
            <div id="footerToast" class="footer-toast"></div>
        </div>
    </div>

    <script src="js/footer-ui.js"></script>
    <script src="js/scroll-forwarding.js"></script>
    <script src="js/card.js"></script>
</body>
</html>
